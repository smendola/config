#!/bin/sh

echo "$@"

# First, convert all file paths to windows style, since
# meld is not a cygwin program
declare -a args
for arg
do
    if [[ $arg = -* ]]
    then
        args[${#args[*]}]=$arg
    else
        args[${#args[*]}]=$(cygpath -ma "$arg")
    fi
done

# Now the REAL hack: run meld with cmd starting a desktop shortcut in (!) and
# passing it command line arguments (!!) Wow...
# This is pretty bogus... but can't get meld to run from cli any other way
/c/Windows/system32/cmd /c "$(cygpath -w /c/Users/Public/Desktop/Meld.lnk)" "${args[@]}"
