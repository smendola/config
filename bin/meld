#!/bin/sh

# --help broken on Windows; pasted in from Linux output
if [[ $1 = --help || $1 = -h ]] ; then
    cat <<EOF 
Usage: 
  meld                        Start with an empty window
  meld <file|dir>             Start a version control comparison
  meld <file> <file> [<file>] Start a 2- or 3-way file comparison
  meld <dir> <dir> [<dir>]    Start a 2- or 3-way directory comparison
  meld <file> <dir>           Start a comparison between file and dir/file

Meld is a file and directory comparison tool.

Options:
  --version             show program's version number and exit
  -h, --help            show this help message and exit
  -L LABEL, --label=LABEL
                        Set label to use instead of file name
  -a, --auto-compare    Automatically compare all differing files on startup
  -u, --unified         Ignored for compatibility
  -o OUTFILE, --output=OUTFILE
                        Set the target file for saving a merge result
  --diff                Creates a diff tab for up to 3 supplied files or
                        directories.
EOF
    exit
fi

# First, convert all file paths to windows style, since
# meld is not a cygwin program
declare -a args
for arg
do
    if [[ $arg = -* ]]
    then
        args[${#args[*]}]=$arg
    else
        args[${#args[*]}]=$(cygpath -ma "$arg")
    fi
done

meld.exe "${args[@]}"


